# 需求文档

本文档详细描述 NetMate 项目的功能需求。

## 1. 项目概述

### 1.1 项目目标

开发一个跨平台的校园网自动登录工具（NetMate），解决校园网需要频繁手动登录的问题。

### 1.2 目标用户

天津科技大学在校师生，需要频繁使用校园网的用户。

### 1.3 支持平台

| 平台 | 技术栈 | 优先级 |
|------|--------|--------|
| Windows | Electron + React | P0 |
| macOS | Electron + React | P0 |
| Android | React Native | P1 |
| iOS | React Native | P2（暂不开发）|

---

## 2. 功能需求

### 2.1 账户管理

#### 2.1.1 多账户支持

- **描述**：用户可以配置多个校园网账户
- **功能点**：
  - 添加账户（用户名、密码、服务器地址、服务商）
  - 删除账户
  - 切换当前使用的账户
  - 查看账户列表

#### 2.1.2 服务商选择

- **描述**：支持不同运营商的校园网认证
- **选项**：
  - 校园网（campus）
  - 中国移动（cmcc）
  - 中国联通（cucc）
  - 中国电信（ctcc）

#### 2.1.3 服务器地址配置

- **描述**：认证服务器地址可自定义
- **默认值**：`http://10.10.102.50:801`

### 2.2 WiFi 配置

#### 2.2.1 多 WiFi 支持

- **描述**：用户可以配置多个 WiFi 网络
- **功能点**：
  - 添加 WiFi 配置（SSID、密码、是否需要认证）
  - 删除 WiFi 配置
  - 查看 WiFi 配置列表
  - 设置 WiFi 优先级

#### 2.2.2 WiFi 认证类型

- **描述**：区分需要校园网认证的 WiFi 和普通 WiFi
- **类型**：
  - **需要认证**：连接后需要向认证服务器发送登录请求
    - 需选择关联的账号（账号已包含服务器地址和服务商信息）
  - **无需认证**：家庭 WiFi、手机热点等，连接即可使用

#### 2.2.3 WiFi 优先级

- **描述**：配置 WiFi 的连接优先级
- **用途**：当心跳检测发现断线且重连失败时，按优先级顺序尝试切换到其他 WiFi

### 2.3 登录认证

#### 2.3.1 手动登录

- **描述**：用户点击按钮手动触发登录
- **前提**：已配置至少一个账户

#### 2.3.2 手动登出

- **描述**：用户点击按钮断开当前连接

#### 2.3.3 自动登录

- **描述**：连接到已配置的 WiFi 后自动触发登录
- **条件**：
  - WiFi 的 `requiresAuth` 为 true
  - 已选择当前账户

### 2.4 心跳检测

#### 2.4.1 心跳开关

- **描述**：用户可手动开启/关闭心跳检测功能
- **默认**：关闭
- **开启后**：系统按配置的间隔定时检测网络连通性

#### 2.4.2 检测间隔

- **描述**：心跳检测的时间间隔
- **默认值**：30 秒
- **最小值**：5 秒

#### 2.4.3 断线重连

- **描述**：检测到断线后自动尝试重新登录
- **流程**：
  1. 检测到网络断开
  2. 尝试重新登录当前网络（最多 N 次）
  3. 若失败，按优先级切换到其他 WiFi
  4. 若目标 WiFi 需要认证，发送登录请求

#### 2.4.4 重试策略

- **描述**：登录失败时的重试机制
- **配置项**：
  - 最大重试次数（默认 3 次）
  - 重试间隔策略（固定延迟 / 指数退避）

### 2.5 状态显示

#### 2.5.1 启动时 WiFi 检测

- **描述**：应用启动时自动检测当前 WiFi 连接状态
- **功能点**：
  - 检测当前是否已连接 WiFi
  - 若已连接，显示当前连接的 WiFi 名称（SSID）
  - 若未连接，显示"未连接 WiFi"状态
- **触发时机**：应用启动时自动执行
- **显示位置**：运行状态页面

#### 2.5.2 连接状态

- **描述**：显示当前网络连接状态
- **状态**：
  - 已连接（connected）
  - 未连接（disconnected）
  - 连接中（connecting）

#### 2.5.3 无账户提示

- **描述**：当用户未配置任何账户时，显示提示信息引导用户添加账户
- **不应显示**："已连接" 状态（因为无法登录）

#### 2.5.4 网络信息

- **描述**：显示当前网络的详细信息
- **信息项**：
  - IP 地址
  - 当前账户
  - 心跳检测状态

### 2.6 日志记录

#### 2.6.1 运行日志

- **描述**：记录应用的运行日志
- **日志级别**：
  - info（信息）
  - success（成功）
  - warn（警告）
  - error（错误）
  - debug（调试）

#### 2.6.2 日志查看

- **描述**：用户可以查看运行日志
- **功能**：
  - 按时间倒序显示
  - 按级别筛选（全部/信息/成功/警告/错误/调试）
  - 显示筛选后的日志数量
  - 清除日志

### 2.7 通知

#### 2.7.1 系统通知

- **描述**：在重要事件发生时推送系统通知
- **事件**：
  - 登录成功
  - 登录失败
  - 网络断开
  - 自动重连成功

#### 2.7.2 通知开关

- **描述**：用户可开启/关闭通知功能
- **默认**：开启

### 2.8 系统集成

#### 2.8.1 开机自启

- **描述**：应用随系统启动自动运行
- **默认**：关闭
- **实现**：
  - Windows / macOS：使用系统注册表 / LaunchAgents
  - Android：注册 BOOT_COMPLETED 广播

#### 2.8.2 系统托盘（桌面端）

- **描述**：最小化到系统托盘
- **功能**：
  - 托盘图标显示连接状态
  - 右键菜单（显示窗口、登录/登出、退出）

#### 2.8.3 后台服务（移动端）

- **描述**：在后台保持运行
- **实现**：Android Foreground Service

### 2.9 自动更新

#### 2.9.1 桌面端更新

- **描述**：自动检测并下载更新
- **实现**：electron-updater + GitHub Releases

#### 2.9.2 移动端更新

- **描述**：应用内检测更新并下载安装
- **实现**：GitHub Releases API + APK 下载安装

---

## 3. 非功能需求

### 3.1 安全性

- 密码使用系统级加密存储
- 敏感信息不上传到任何服务器
- 日志中不记录密码等敏感信息

### 3.2 性能

- 心跳检测对系统资源占用最小化
- 后台运行时不影响正常使用

### 3.3 可用性

- 界面简洁直观
- 使用图标增强可读性（lucide-react）
- 支持中文界面

### 3.4 可维护性

- 核心业务逻辑跨平台共享
- 模块化设计
- TypeScript 强类型

---

## 4. 用户界面

### 4.1 页面结构

| 页面 | 功能 |
|------|------|
| 运行状态 | 显示连接状态、当前账户、网络信息 |
| 配置设置 | 通用设置、账号管理、WiFi 配置 |
| 运行日志 | 查看运行日志 |
| 关于 | 应用信息、版本、更新 |

### 4.2 图标使用

使用 lucide-react 图标库，主要图标：

- `Globe` - 运行状态页面标题
- `Settings` - 配置设置页面标题
- `User` - 账户相关
- `Wifi` - WiFi 相关
- `Server` - 服务器地址
- `Heart` - 心跳检测
- `CheckCircle2` - 已连接状态
- `XCircle` - 未连接状态
- `Loader` - 连接中状态
- `AlertCircle` - 警告提示

---

## 5. 验收标准

### 5.1 功能验收

- [ ] 可以添加、删除、切换账户
- [ ] 可以添加、删除 WiFi 配置
- [ ] WiFi 配置支持认证类型切换
- [ ] 手动登录/登出功能正常
- [ ] 启动时自动检测 WiFi 连接状态并显示
- [ ] 心跳检测开关可用
- [ ] 断线自动重连功能正常
- [ ] 未配置账户时显示提示
- [ ] 日志记录和查看功能正常
- [ ] 系统通知功能正常
- [ ] 开机自启功能正常

### 5.2 平台验收

- [ ] Windows 桌面端功能完整
- [ ] macOS 桌面端功能完整
- [ ] Android 移动端功能完整

### 5.3 质量验收

- [ ] 无明显 UI 卡顿
- [ ] 后台运行稳定
- [ ] 密码加密存储
- [ ] 无重大安全漏洞
