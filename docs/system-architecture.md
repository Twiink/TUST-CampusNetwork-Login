# NetMate 系统架构详解

> 本文档提供 NetMate 项目的详细系统架构图和组件说明。

---

## 目录

1. [整体架构图](#1-整体架构图)
2. [技术栈架构](#2-技术栈架构)
3. [数据流架构](#3-数据流架构)
4. [核心服务架构](#4-核心服务架构)
5. [平台适配架构](#5-平台适配架构)
6. [模块依赖关系](#6-模块依赖关系)
7. [状态管理架构](#7-状态管理架构)
8. [IPC 通信架构](#8-ipc-通信架构)
9. [安全架构](#9-安全架构)

---

## 1. 整体架构图

### 1.1 分层架构

```
+------------------------------------------------------------------------------+
|                              Apps Layer                                      |
+------------------------------------------------------------------------------+
|                                                                              |
|   +--------------------------------+   +--------------------------------+    |
|   |        apps/desktop            |   |         apps/mobile            |    |
|   +--------------------------------+   +--------------------------------+    |
|   |                                |   |                                |    |
|   |   +------------------------+   |   |   +------------------------+   |    |
|   |   |   Electron Main        |   |   |   |   React Native UI      |   |    |
|   |   |   +------+------+----+ |   |   |   |   +------+------+----+ |   |    |
|   |   |   | IPC  | Tray |Svc | |   |   |   |   |Screen|Hooks |Ctx | |   |    |
|   |   |   +------+------+----+ |   |   |   |   +------+------+----+ |   |    |
|   |   +------------------------+   |   |   +------------------------+   |    |
|   |                                |   |                                |    |
|   |   +------------------------+   |   |   +------------------------+   |    |
|   |   |   React Renderer       |   |   |   |   Android Native       |   |    |
|   |   |   +------+------+----+ |   |   |   |   +------+------+----+ |   |    |
|   |   |   |Pages |Hooks |UI  | |   |   |   |   | Wifi | Boot |Svc | |   |    |
|   |   |   +------+------+----+ |   |   |   |   +------+------+----+ |   |    |
|   |   +------------------------+   |   |   +------------------------+   |    |
|   |                                |   |                                |    |
|   +--------------------------------+   +--------------------------------+    |
|                                                                              |
+------------------------------------------------------------------------------+
                                       |
                                       v
+------------------------------------------------------------------------------+
|                            Shared Layer                                      |
+------------------------------------------------------------------------------+
|                                                                              |
|   +------------------------------------------------------------------------+ |
|   |                        packages/shared                                 | |
|   |   +----------+  +----------+  +----------+  +--------+  +----------+   | |
|   |   | Services |  |  Models  |  |  Types   |  | Utils  |  |Constants |   | |
|   |   +----------+  +----------+  +----------+  +--------+  +----------+   | |
|   |   |AuthSvc   |  | Logger   |  | AuthType |  |urlEnc  |  | defaults |   | |
|   |   |NetDetect |  | Config   |  | CfgType  |  |httpCli |  | errors   |   | |
|   |   |AcctMgr   |  |          |  | NetType  |  |validat |  |          |   | |
|   |   |WifiMgr   |  |          |  | LogType  |  |        |  |          |   | |
|   |   |CfgMgr    |  |          |  |          |  |        |  |          |   | |
|   |   +----------+  +----------+  +----------+  +--------+  +----------+   | |
|   +------------------------------------------------------------------------+ |
|                                                                              |
+------------------------------------------------------------------------------+
                                       |
                                       v
+------------------------------------------------------------------------------+
|                         System / Network Layer                               |
+------------------------------------------------------------------------------+
|   +--------------+  +--------------+  +--------------+  +--------------+     |
|   |   OS APIs    |  |  HTTP/HTTPS  |  |  WiFi Stack  |  | File System  |     |
|   +--------------+  +--------------+  +--------------+  +--------------+     |
+------------------------------------------------------------------------------+
```

### 1.2 组件关系图

```
                                +------------------+
                                |   User Action    |
                                +--------+---------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                  UI Layer                                    |
|  +--------+  +----------+  +--------+  +--------+  +---------+               |
|  |  Home  |  | Settings |  |  Logs  |  | About  |  | Sidebar |               |
|  +---+----+  +----+-----+  +---+----+  +---+----+  +----+----+               |
|      |            |            |           |            |                    |
|      +------+-----+-----+------+-----+-----+------------+                    |
|                         |                                                    |
|                         v                                                    |
|                   +-----------+                                              |
|                   |React Hooks|                                              |
|  +----------------+-----------+----------------+                             |
|  |     useAuth       useNetwork     useConfig  |                             |
|  |     +-- login()   +-- getStatus  +-- get()  |                             |
|  |     +-- logout()  +-- getIP()    +-- save() |                             |
|  |                                             |                             |
|  |     useAccounts   useWifiCfgs    useLogs    |                             |
|  |     +-- add()     +-- add()      +-- get()  |                             |
|  |     +-- remove()  +-- remove()   +-- clear()|                             |
|  +---------------------------------------------+                             |
+------------------------------------------------------------------------------+
                                         |
                                         | IPC / Native Bridge
                                         v
+------------------------------------------------------------------------------+
|                          Main Process / Native Layer                         |
|                                                                              |
|  +------------------------------------------------------------------------+  |
|  |                           IPC Handlers                                 |  |
|  |  +----------+  +----------+  +----------+  +----------+  +----------+  |  |
|  |  | auth.ts  |  |account.ts|  | wifi.ts  |  |config.ts |  |network.ts|  |  |
|  |  +----+-----+  +----+-----+  +----+-----+  +----+-----+  +----+-----+  |  |
|  +------------------------------------------------------------------------+  |
|                                         |                                    |
|                                         v                                    |
|  +------------------------------------------------------------------------+  |
|  |                        Platform Services                               |  |
|  |  +-----------+  +-----------+  +-----------+  +-----------+            |  |
|  |  |   Tray    |  |AutoLaunch |  |  Notify   |  |  Updater  |            |  |
|  |  +-----------+  +-----------+  +-----------+  +-----------+            |  |
|  |  +-----------+  +-----------+  +-----------+  +-----------+            |  |
|  |  |   Store   |  |WifiDetect |  |WifiSwitch |  |AutoReconn |            |  |
|  |  +-----------+  +-----------+  +-----------+  +-----------+            |  |
|  +------------------------------------------------------------------------+  |
+------------------------------------------------------------------------------+
                                         |
                                         | Call Shared Services
                                         v
+------------------------------------------------------------------------------+
|                          Shared Core Services                                |
|                                                                              |
|  +------------------------------------------------------------------------+  |
|  |                         AuthService                                    |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  |  | buildLoginUrl()|  |    login()     |  |   logout()     |            |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  +------------------------------------------------------------------------+  |
|                                         |                                    |
|  +------------------------------------------------------------------------+  |
|  |                       NetworkDetector                                  |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  |  | checkConnect() |  |isAuthenticated|  | startPolling() |            |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  +------------------------------------------------------------------------+  |
|                                         |                                    |
|  +------------------------------------------------------------------------+  |
|  |                       AccountManager                                   |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  |  | addAccount()   |  |removeAccount() |  |switchAccount() |            |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  +------------------------------------------------------------------------+  |
|                                         |                                    |
|  +------------------------------------------------------------------------+  |
|  |                        WifiManager                                     |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  |  | addWifi()      |  | removeWifi()   |  | matchWifi()    |            |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  +------------------------------------------------------------------------+  |
|                                         |                                    |
|  +------------------------------------------------------------------------+  |
|  |                       ConfigManager                                    |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  |  | getConfig()    |  |   update()     |  |  validate()    |            |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  +------------------------------------------------------------------------+  |
|                                         |                                    |
|  +------------------------------------------------------------------------+  |
|  |                          Logger                                        |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  |  |    info()      |  |    warn()      |  |    error()     |            |  |
|  |  +----------------+  +----------------+  +----------------+            |  |
|  +------------------------------------------------------------------------+  |
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
                              +------------------+
                              | External Service |
                              | Campus Auth Srv  |
                              | GitHub Releases  |
                              +------------------+
```

---

## 2. 技术栈架构

```
+------------------------------------------------------------------------------+
|                            Tech Stack                                        |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+------------------------+------------------------+|
|  |       Desktop          |        Mobile          |        Shared          ||
|  |      (Electron)        |    (React Native)      |   (packages/shared)    ||
|  +------------------------+------------------------+------------------------+|
|  |                        |                        |                        ||
|  |  Frontend:             |  Frontend:             |  Core Logic:           ||
|  |  - React 18            |  - React Native 0.83   |  - TypeScript strict   ||
|  |  - TypeScript          |  - TypeScript          |  - tsup (ESM + CJS)    ||
|  |  - Vite                |  - Metro Bundler       |  - Vitest              ||
|  |  - Zustand             |  - React Navigation    |                        ||
|  |                        |                        |                        ||
|  |  Main Process:         |  Android Native:       |                        ||
|  |  - Electron            |  - Kotlin              |                        ||
|  |  - IPC                 |  - Foreground Service  |                        ||
|  |                        |  - BOOT_COMPLETED      |                        ||
|  |                        |                        |                        ||
|  |  Platform Services:    |  Storage & Security:   |                        ||
|  |  - electron-store      |  - async-storage       |                        ||
|  |  - auto-launch         |  - keychain            |                        ||
|  |  - electron-updater    |                        |                        ||
|  |  - notifications       |                        |                        ||
|  |                        |                        |                        ||
|  +------------------------+------------------------+------------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 3. 数据流架构

### 3.1 数据流图

```
+------------------------------------------------------------------------------+
|                             Data Flow                                        |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+------------------------+------------------------+|
|  |     User Actions       |      UI Rendering      |    State Management    ||
|  |  (click/input/config)  |  (React Components)    |    (Zustand Store)     ||
|  +------------------------+------------------------+------------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+------------------------+------------------------+|
|  |   Platform Adapter     |    Shared Services     |     System Layer       ||
|  |   - IPC (Desktop)      |   - AuthService        |   - OS API             ||
|  |   - Native (Mobile)    |   - NetworkDetector    |   - HTTP Requests      ||
|  |                        |   - AccountManager     |   - WiFi Stack         ||
|  |                        |   - WifiManager        |   - File System        ||
|  |                        |   - ConfigManager      |                        ||
|  |                        |   - Logger             |                        ||
|  +------------------------+------------------------+------------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+------------------------+------------------------+|
|  |   Campus Auth Server   |    GitHub Releases     |                        ||
|  +------------------------+------------------------+------------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
```

### 3.2 数据流时序

```
+------------------------------------------------------------------------------+
|                         User Login Data Flow                                 |
+------------------------------------------------------------------------------+
|                                                                              |
|   User                 UI                  Hook                 IPC          |
|    |                   |                    |                    |           |
|    | Click Login       |                    |                    |           |
|    |------------------>|                    |                    |           |
|    |                   | call login()       |                    |           |
|    |                   |------------------->|                    |           |
|    |                   |                    | invoke('auth:login')|          |
|    |                   |                    |------------------->|           |
|    |                   |                    |                    |           |
|    |                   |                    |           call AuthService     |
|    |                   |                    |                    |---------->|
|    |                   |                    |                    |           |
|    |                   |                    |             send HTTP request  |
|    |                   |                    |                    |---------->|
|    |                   |                    |                    |           |
|    |                   |                    |              return result     |
|    |                   |                    |                    |<----------|
|    |                   |                    | return result      |           |
|    |                   |                    |<-------------------|           |
|    |                   | return result      |                    |           |
|    |                   |<-------------------|                    |           |
|    |                   |                    |                    |           |
|    | Show result       |                    |                    |           |
|    |<------------------|                    |                    |           |
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 4. 核心服务架构

### 4.1 服务类图

```
+------------------------------------------------------------------------------+
|                           Core Services                                      |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +------------------------+  +------------------+|
|  |     AuthService        |  |    NetworkDetector     |  |   ConfigManager  ||
|  +------------------------+  +------------------------+  +------------------+|
|  |                        |  |                        |  |                  ||
|  | Fields:                |  | Fields:                |  | Fields:          ||
|  | +------------------+   |  | +------------------+   |  | +--------------+ ||
|  | | - serverUrl      |   |  | | - pollingTimer   |   |  | | - storage    | ||
|  | +------------------+   |  | | - callback       |   |  | | - config     | ||
|  |                        |  | +------------------+   |  | +--------------+ ||
|  | Methods:               |  |                        |  |                  ||
|  | +------------------+   |  | Methods:               |  | Methods:         ||
|  | | + login()        |   |  | +------------------+   |  | +--------------+ ||
|  | | + logout()       |   |  | | + checkConnect() |   |  | | + load()     | ||
|  | | + buildLoginUrl()|   |  | | + isAuth()       |   |  | | + save()     | ||
|  | | + parseResponse()|   |  | | + startPolling() |   |  | | + getConfig()| ||
|  | +------------------+   |  | | + stopPolling()  |   |  | | + update()   | ||
|  |                        |  | +------------------+   |  | +--------------+ ||
|  +------------------------+  +------------------------+  +------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +------------------------+  +------------------+|
|  |    AccountManager      |  |      WifiManager       |  |   RetryPolicy    ||
|  +------------------------+  +------------------------+  +------------------+|
|  |                        |  |                        |  |                  ||
|  | Fields:                |  | Fields:                |  | Fields:          ||
|  | +------------------+   |  | +------------------+   |  | +--------------+ ||
|  | | - configManager  |   |  | | - configManager  |   |  | | - maxRetries | ||
|  | +------------------+   |  | +------------------+   |  | | - delay      | ||
|  |                        |  |                        |  | | - backoff    | ||
|  | Methods:               |  | Methods:               |  | +--------------+ ||
|  | +------------------+   |  | +------------------+   |  |                  ||
|  | | + getAccounts()  |   |  | | + getWifiConfigs()|  |  | Methods:         ||
|  | | + addAccount()   |   |  | | + addWifi()      |   |  | +--------------+ ||
|  | | + removeAccount()|   |  | | + removeWifi()   |   |  | | + execute()  | ||
|  | | + switchAccount()|   |  | | + matchWifi()    |   |  | +--------------+ ||
|  | +------------------+   |  | +------------------+   |  |                  ||
|  |                        |  |                        |  |                  ||
|  +------------------------+  +------------------------+  +------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 5. 平台适配架构

```
+------------------------------------------------------------------------------+
|                          Platform Adapters                                   |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +------------------------+  +------------------+|
|  |    StorageAdapter      |  |      WifiAdapter       |  | AutoLaunchAdapter||
|  +------------------------+  +------------------------+  +------------------+|
|  |                        |  |                        |  |                  ||
|  | +------------------+   |  | +------------------+   |  | +--------------+ ||
|  | | + get()          |   |  | | + getCurrentWifi()|  |  | | + enable()   | ||
|  | | + set()          |   |  | | + connect()      |   |  | | + disable()  | ||
|  | | + remove()       |   |  | | + disconnect()   |   |  | | + isEnabled()| ||
|  | | + clear()        |   |  | | + scan()         |   |  | +--------------+ ||
|  | +------------------+   |  | +------------------+   |  |                  ||
|  |                        |  |                        |  | Impl:            ||
|  | Impl:                  |  | Impl:                  |  | - Desktop:       ||
|  | - Desktop:             |  | - Desktop:             |  |   auto-launch    ||
|  |   electron-store       |  |   netsh/networksetup   |  | - Mobile:        ||
|  |   + safeStorage        |  | - Mobile:              |  |   BOOT_COMPLETED ||
|  | - Mobile:              |  |   WifiModule.kt        |  |                  ||
|  |   async-storage        |  |                        |  |                  ||
|  |   + keychain           |  |                        |  |                  ||
|  |                        |  |                        |  |                  ||
|  +------------------------+  +------------------------+  +------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +--------------------------------------------+  |
|  | NotificationAdapter    |  |             All Adapters                   |  |
|  +------------------------+  +--------------------------------------------+  |
|  |                        |  |                                            |  |
|  | +------------------+   |  |  +--------------------------------------+  |  |
|  | | + show()         |   |  |  |  Platform-agnostic core business    |  |  |
|  | +------------------+   |  |  |  logic calls platform-specific      |  |  |
|  |                        |  |  |  implementations via interfaces      |  |  |
|  | Impl:                  |  |  +--------------------------------------+  |  |
|  | - Desktop:             |  |                                            |  |
|  |   Electron Notify      |  |                                            |  |
|  | - Mobile:              |  |                                            |  |
|  |   @notifee/react-native|  |                                            |  |
|  |                        |  |                                            |  |
|  +------------------------+  +--------------------------------------------+  |
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 6. 模块依赖关系

```
+------------------------------------------------------------------------------+
|                         Module Dependencies                                  |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +------------------------+  +------------------+|
|  |    apps/desktop        |  |     apps/mobile        |  | packages/shared  ||
|  +------------------------+  +------------------------+  +------------------+|
|  |                        |  |                        |  |                  ||
|  |  electron/             |  |  src/                  |  |  shared/         ||
|  |  - main.ts             |  |  - App.tsx             |  |  - services/     ||
|  |  - preload.ts          |  |  - screens/            |  |  - types/        ||
|  |  - ipc/                |  |  - hooks/              |  |  - utils/        ||
|  |  - services/           |  |  - native/             |  |  - models/       ||
|  |                        |  |                        |  |  - constants/    ||
|  |  src/                  |  |  android/              |  |                  ||
|  |  - main.tsx            |  |  - app/src/main/java/  |  |                  ||
|  |  - App.tsx             |  |    - modules/          |  |                  ||
|  |  - pages/              |  |    - service/          |  |                  ||
|  |  - hooks/              |  |    - receiver/         |  |                  ||
|  |  - components/         |  |                        |  |                  ||
|  |                        |  |                        |  |                  ||
|  +------------------------+  +------------------------+  +------------------+|
|            |                           |                                     |
|            +-------------+-------------+                                     |
|                          |                                                   |
|                          v                                                   |
|                 +------------------+                                         |
|                 |   @repo/shared   |                                         |
|                 | (Shared Package) |                                         |
|                 +------------------+                                         |
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 7. 状态管理架构

```
+------------------------------------------------------------------------------+
|                        State Management                                      |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +------------------------+  +------------------+|
|  |  AppState (Zustand)    |  |        Actions         |  |    Selectors     ||
|  +------------------------+  +------------------------+  +------------------+|
|  |                        |  |                        |  |                  ||
|  | +------------------+   |  | +------------------+   |  | +--------------+ ||
|  | | accounts[]       |   |  | | setAccounts()    |   |  | | selectCurr() | ||
|  | | currentAccountId |   |  | | addAccount()     |   |  | | selectWifi() | ||
|  | | wifiConfigs[]    |   |  | | removeAccount()  |   |  | | selectStat() | ||
|  | | settings         |   |  | | switchAccount()  |   |  | | selectLogs() | ||
|  | | networkStatus    |   |  | | setWifiConfigs() |   |  | +--------------+ ||
|  | | isLoggedIn       |   |  | | updateSettings() |   |  |                  ||
|  | | logs[]           |   |  | | setNetworkStatus()|  |  |                  ||
|  | +------------------+   |  | +------------------+   |  |                  ||
|  |                        |  |                        |  |                  ||
|  +------------------------+  +------------------------+  +------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +--------------------------------------------+  |
|  |    React Context       |  |           Component Subscriptions          |  |
|  |    (AppContext)        |  |                                            |  |
|  +------------------------+  +--------------------------------------------+  |
|  |                        |  |                                            |  |
|  | +------------------+   |  | +--------------------------------------+   |  |
|  | | Provider         |   |  | | useStore()                          |   |  |
|  | | (State Provider) |   |  | | useAccount()                        |   |  |
|  | +------------------+   |  | | useWifi()                           |   |  |
|  |                        |  | | useNetwork()                        |   |  |
|  |                        |  | | useLogs()                           |   |  |
|  |                        |  | +--------------------------------------+   |  |
|  |                        |  |                                            |  |
|  +------------------------+  +--------------------------------------------+  |
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 8. IPC 通信架构

```
+------------------------------------------------------------------------------+
|                           IPC Architecture                                   |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +------------------------+  +------------------+|
|  |  Renderer Process      |  |     IPC Channels       |  |   Main Process   ||
|  +------------------------+  +------------------------+  +------------------+|
|  |                        |  |                        |  |                  ||
|  | +------------------+   |  | +------------------+   |  | +--------------+ ||
|  | | Hooks            |   |  | | 'auth:*'         |   |  | | IPC Handlers | ||
|  | | - useAuth        |   |  | | 'account:*'      |   |  | | - authHdl    | ||
|  | | - useNetwork     |   |  | | 'wifi:*'         |   |  | | - acctHdl    | ||
|  | | - useConfig      |   |  | | 'config:*'       |   |  | | - wifiHdl    | ||
|  | | - useLogs        |   |  | | 'network:*'      |   |  | | - cfgHdl     | ||
|  | |                  |   |  | | 'log:*'          |   |  | | - netHdl     | ||
|  | | preload.ts       |   |  | | 'tray:*'         |   |  | | - logHdl     | ||
|  | | (API Exposed)    |   |  | | 'notify:*'       |   |  | +--------------+ ||
|  | +------------------+   |  | | 'updater:*'      |   |  |                  ||
|  |                        |  | +------------------+   |  | +--------------+ ||
|  |                        |  |                        |  | | Platform Svc | ||
|  |                        |  |                        |  | | - TrayService| ||
|  |                        |  |                        |  | | - StoreServ  | ||
|  |                        |  |                        |  | | - NotifySvc  | ||
|  |                        |  |                        |  | | - AutoLaunch | ||
|  |                        |  |                        |  | | - Updater    | ||
|  |                        |  |                        |  | +--------------+ ||
|  |                        |  |                        |  |                  ||
|  +------------------------+  +------------------------+  +------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------------------------------------------------------+  |
|  |                         @repo/shared                                   |  |
|  |  +----------+  +----------+  +----------+  +----------+  +----------+  |  |
|  |  |AuthSvc   |  | AcctMgr  |  | WifiMgr  |  | NetDetect|  | CfgMgr   |  |  |
|  |  +----------+  +----------+  +----------+  +----------+  +----------+  |  |
|  +------------------------------------------------------------------------+  |
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 9. 安全架构

```
+------------------------------------------------------------------------------+
|                          Security Architecture                               |
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------+  +------------------------+  +------------------+|
|  |   Password Storage     |  |     Log Sanitization   |  | Context Isolation||
|  +------------------------+  +------------------------+  +------------------+|
|  |                        |  |                        |  |                  ||
|  | +------------------+   |  | +------------------+   |  | +--------------+ ||
|  | | Desktop:         |   |  | | Field Filtering  |   |  | | preload.ts   | ||
|  | | - electron-store |   |  | | - password -> *  |   |  | | - minimal API| ||
|  | | - safeStorage    |   |  | | - mac -> *****   |   |  | | - no Node.js | ||
|  | +------------------+   |  | +------------------+   |  | +--------------+ ||
|  |                        |  |                        |  |                  ||
|  | +------------------+   |  |                        |  |                  ||
|  | | Mobile:          |   |  |                        |  |                  ||
|  | | - async-storage  |   |  |                        |  |                  ||
|  | | - keychain       |   |  |                        |  |                  ||
|  | +------------------+   |  |                        |  |                  ||
|  |                        |  |                        |  |                  ||
|  +------------------------+  +------------------------+  +------------------+|
|                                                                              |
+------------------------------------------------------------------------------+
                                         |
                                         v
+------------------------------------------------------------------------------+
|                                                                              |
|  +------------------------------------------------------------------------+  |
|  |                     Network Transport Security                         |  |
|  |  +------------------------------------------------------------------+  |  |
|  |  |  - HTTPS Requests                                                |  |  |
|  |  |  - Sensitive data processed locally                              |  |  |
|  |  +------------------------------------------------------------------+  |  |
|  +------------------------------------------------------------------------+  |
|                                                                              |
+------------------------------------------------------------------------------+
```

---

## 附录

### A. 关键文件路径

| 模块         | 路径                                       |
| ------------ | ------------------------------------------ |
| 共享服务     | `packages/shared/src/services/`            |
| 类型定义     | `packages/shared/src/types/`               |
| 工具函数     | `packages/shared/src/utils/`               |
| 数据模型     | `packages/shared/src/models/`              |
| 常量定义     | `packages/shared/src/constants/`           |
| 桌面端主进程 | `apps/desktop/electron/`                   |
| 桌面端UI     | `apps/desktop/src/`                        |
| 移动端       | `apps/mobile/src/`                         |
| Android原生  | `apps/mobile/android/app/src/main/java/`   |

### B. 端口说明

| 服务              | 端口 | 说明       |
| ----------------- | ---- | ---------- |
| Vite 开发服务器   | 5173 | 桌面端开发 |
| Metro Bundler     | 8081 | 移动端开发 |

---

*文档版本: 1.0*
*最后更新: 2026-01-02*
